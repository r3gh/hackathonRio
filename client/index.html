
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Mancha Criminal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="index, follow"/>
  <meta name="description" content="This example shows a leaflet heatmap layer example for the heatmap.js leaflet plugin"/>
  <meta name="keywords" content="leaflet heatmap, heatmap.js plugin leaflet"/>
  <link rel="stylesheet" href="https://www.patrick-wied.at/static/heatmapjs/assets/css/commons.css"/>
  <link rel="stylesheet" href="https://www.patrick-wied.at/static/heatmapjs/assets/css/example-commons.css"/>
  <link rel="stylesheet" href="https://www.patrick-wied.at/static/heatmapjs/assets/third-party/prism/prism.css"/>
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/leaflet.css"/>
  <link rel="stylesheet" href="css/bootstrap-grid.min.css"/>
  <link rel="stylesheet" href="css/bootstrap-reboot.min.css"/>
  <link rel="stylesheet" href="css/bootstrap.min.css"/>
  <link rel="stylesheet" href="css/font-awesome.css"/>
  <link rel="stylesheet" href="css/main.css"/>
  <script src="//cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/leaflet.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/leaflet.js"></script>
  <style>#share{display:none;float:right;font-size:14px;line-height:170%}.symbol{display:inline!important;float:right}</style>
</head>
<body>
  <script src="https://www.patrick-wied.at/static/heatmapjs/assets/js/heatmap.min.js"></script>
  <script src="https://www.patrick-wied.at/static/heatmapjs/assets/js/leaflet-heatmap.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="bootstrap.bundle.min.js"></script>
  <script src="bootstrap.min.js"></script>
  <script src="teste.js"></script>
  <script src="sendData.js"></script>
  <script>
      
      function enviaDadosPython(){
        
        $.ajax({                 
            type: 'POST',                                  
            url: 'source.php',                 
            async: false,                 
            data: "tipoProcessamento=python2",
            success: function(response) {
                //console.log(response);
                //console.log(response.length);
                response = JSON.parse(response);
                response = JSON.parse(response[0]);
                //$("#pdfs").attr('value',response);
                for(i=0;i<response.length; i++){
                    localities[i].count = response[i];
                }
                //console.log(localities[0].count);
                //carregaPontosMapa();
            }             
        });  
    }
    enviaDadosPython();
    
    var baseLayer = L.tileLayer(
      'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
        maxZoom: 18
      }
    );
    var testData = {
        max: 8,
        data: localities//[{"lat": 24.6408, "lng":46.7728, "count": 3},{"lat": 50.75, "lng":-1.55, "count": 1}]
    };
    var cfg = {
      // radius should be small ONLY if scaleRadius is true (or small radius is intended)
      // if scaleRadius is false it will be the constant radius used in pixels
      "radius": 20,
      "maxOpacity": 1, 
      // scales the radius based on map zoom
      //"scaleRadius": true, 
      // if set to false the heatmap uses the global maximum for colorization
      // if activated: uses the data maximum within the current map boundaries 
      //   (there will always be a red spot with useLocalExtremas true)
      //"useLocalExtrema": true,
      // which field name in your data represents the latitude - default "lat"
      latField: 'lat',
      // which field name in your data represents the longitude - default "lng"
      lngField: 'lng',
      // which field name in your data represents the data value - default "value"
      valueField: 'count'
    };


    var heatmapLayer = new HeatmapOverlay(cfg);

    var map = new L.Map('map-canvas', {
      center: new L.LatLng(-22.8797876, -43.5631799),
      zoom: 10,
      layers: [baseLayer, heatmapLayer]
    });

    heatmapLayer.setData(testData);
  </script>
  <script src="https://www.patrick-wied.at/static/heatmapjs/assets/third-party/prism/prism.js"></script>
  <!-- Gráficos por tipo de violência, por tempo de ocorrência, ocorrência por gênero, 
  quanto de valores foi perdido -->

<!-- title varchar(255),
  description TEXT,
  latitude numeric,
  longitude numeric,
  type_violence numeric,
  event_data timestamp,
  address varchar(255),
  icon varchar(255),
  county varchar(255),
  email varchar(255),
  name varchar(255),
  bulletin_occurrence varchar(255),
  damage_value numeric,
  neighborhood varchar(255),
  sex varchar(40) -->
  <!-- <div id="pontos"></div>
  <div id="pdfs"></div> -->
    <div class="hack">
      <div class="hack-menu">
          <div class="hack-cor-logo">
              <img src="./img/logo_centrodeoperacoesdorio.png">
          </div>
          <div class="btn-group-vertical" role="toolbar">
            <div class="btn-group" role="group">
                <i class="fa fa-line-chart" aria-hidden="true"></i>
                <span class='text'>Gráficos</span> 
            </div>
            <div class="btn-group" role="group">
              <i class="fa fa-map" aria-hidden="true"></i>
              <span class='text'>Mapa</span>
            </div>
          </div>
      </div>
      <div class="hack-content">
        <div class="heatmap" id="map-canvas">
        </div>
      </div>
    </div>
  </body>
</html>